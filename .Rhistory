library(dplyr)
# 讀取資料
bird_1 <- read.table ("D:/碩士資料庫/碩三上課程/Ocean R/Ocean-R-Final-project/dwca-trait_454-v1.68/extendedmeasurementorfact.txt", header = TRUE, sep = "\t", fill = TRUE)
bird_2 <- read.table ("D:/碩士資料庫/碩三上課程/Ocean R/Ocean-R-Final-project/dwca-trait_454-v1.68/measurementorfacts.txt", header = TRUE, sep = "\t", fill = TRUE)
bird_3 <-  read.table ("D:/碩士資料庫/碩三上課程/Ocean R/Ocean-R-Final-project/dwca-trait_454-v1.68/taxon.txt", header = TRUE, sep = "\t", quote = "", fill = TRUE)
# 載入所需的套件
library(dplyr)
co_flocks_nbd <- bird_2 %>%
filter (measurementType %in% c("Flocks_ConspecificsNonBreedingSeason"))
# 選非繁殖季同種異種群聚的的資料
co_flocks_nbd <- bird_2 %>%
filter (measurementType %in% c("Flocks_ConspecificsNonBreedingSeason"))
# 取非Territoriality_NonBreedingSeason鳥類
nt_nbs <- bird_2 %>%
filter (measurementType == "Territoriality_NonBreedingSeason" & measurementValue == 0)
# 選人為棲息地/非人為棲息地的資料
human_habitat <- bird_2 %>%
filter (measurementType %in%
c("Habitat_DrylandFarming",
"Habitat_UrbanParks",
"Habitat_UrbanRuralArea",
"Habitat_AquaculturePonds",
"Habitat_SaltExploitationSites",
"Habitat_PaddyField") &
measurementValue == 1) %>%
mutate (habitat = "Anthropogenic habitat")
# 在 filter() 中，== 適合用於匹配單一值，而當有多個值需要篩選時，應使用 %in%。%in% 可以有效地一次性檢查一組值。如果直接使用 ==，只會選c()中的第一個值
nonhuman_habitat <- bird_2 %>%
filter (grepl ("Habitat", measurementType)
& !(measurementType %in% c("Habitat_DrylandFarming",
"Habitat_UrbanParks",
"Habitat_UrbanRuralArea",
"Habitat_AquaculturePonds",
"Habitat_SaltExploitationSites",
"Habitat_PaddyField")) &
measurementValue == 1) %>%
mutate (habitat = "Natural habitat")
maj_habitat <-
rbind (nonhuman_habitat, human_habitat) %>%
group_by (id, habitat) %>%
tally () %>%
group_by (id) %>%
filter (n == max (n) & n != min(n)) %>%
select (id, majority_habitat = habitat)
co_flock_habitat <- co_flocks_nbd %>%
inner_join (maj_habitat, by = "id") %>%
inner_join(bird_3, by = "id") %>%
filter (id %in% nt_nbs$id)
chisq.test (co_flock_habitat$measurementValue, co_flock_habitat$majority_habitat)
fisher.test (co_flock_habitat$measurementValue, co_flock_habitat$majority_habitat)
bird_glm <- glm (measurementValue ~ majority_habitat,
data = co_flock_habitat,
family = binomial)
summary (bird_glm)
# 計算每個 habitat 和 measurementValue 的出現次數
stacked_data <- co_flock_habitat %>%
group_by (majority_habitat, measurementValue) %>%
summarise (count = n ()) %>%
ungroup ()
# 計算比例
stacked_data <- stacked_data %>%
group_by (majority_habitat) %>%
mutate (percentage = count / sum (count))
library(ggplot2)
ggplot(stacked_data, aes(x = majority_habitat, y = percentage, fill = as.factor (measurementValue))) +
geom_bar(stat = "identity", position = "stack", width = 0.6) +
scale_fill_manual(values = c("1" = "skyblue", "0" = "lightcoral"),
labels = c("1 (Flocking)", "0 (No Flocking)"),
name = "Flocking Behavior") +
labs(title = "Flocking Behavior by Habitat",
x = "Habitat Type",
y = "Proportion") +
theme_minimal() +
theme (legend.position = "top",
plot.title = element_text (hjust = 0.5, size = 16),
plot.margin = margin (20, 20, 20, 20),
axis.title.x = element_text (margin = margin(t = 15), size = 12),
axis.title.y = element_text (margin = margin(r = 10), size = 12),
axis.text.x = element_text (size = 12),
axis.text.y = element_text (size = 12)) # 標題居中
summary (bird_glm)
ggplot(stacked_data, aes(x = majority_habitat, y = percentage, fill = as.factor (measurementValue))) +
geom_bar(stat = "identity", position = "stack", width = 0.6) +
scale_fill_manual(values = c("1" = "skyblue", "0" = "lightcoral"),
labels = c("1 (Flocking)", "0 (No Flocking)"),
name = "Flocking Behavior") +
labs(title = "Flocking Behavior by Habitat",
x = "Habitat Type",
y = "Proportion") +
theme_minimal() +
theme (legend.position = "top",
plot.title = element_text (hjust = 0.5, size = 16), # 標題居中
plot.margin = margin (20, 20, 20, 20),
axis.title.x = element_text (margin = margin(t = 15), size = 12),
axis.title.y = element_text (margin = margin(r = 10), size = 12),
axis.text.x = element_text (size = 12),
axis.text.y = element_text (size = 12),
annotate("text", x = 1.5, y = 0.9, label = "*", size = 6, color = "black"),  # 添加星號
annotate("segment", x = 1, xend = 2, y = 0.85, yend = 0.85, color = "black", size = 0.5))  # 添加橫線)
ggplot(stacked_data, aes(x = majority_habitat, y = percentage, fill = as.factor (measurementValue))) +
geom_bar(stat = "identity", position = "stack", width = 0.6) +
scale_fill_manual(values = c("1" = "skyblue", "0" = "lightcoral"),
labels = c("1 (Flocking)", "0 (No Flocking)"),
name = "Flocking Behavior") +
labs(title = "Flocking Behavior by Habitat",
x = "Habitat Type",
y = "Proportion") +
theme_minimal() +
theme (legend.position = "top",
plot.title = element_text (hjust = 0.5, size = 16), # 標題居中
plot.margin = margin (20, 20, 20, 20),
axis.title.x = element_text (margin = margin(t = 15), size = 12),
axis.title.y = element_text (margin = margin(r = 10), size = 12),
axis.text.x = element_text (size = 12),
axis.text.y = element_text (size = 12) +
annotate ("text", x = 1.5, y = 0.9, label = "*", size = 6, color = "black") +  # 添加星號
annotate ("segment", x = 1, xend = 2, y = 0.85, yend = 0.85, color = "black", size = 0.5))
library(ggpubr)
ggplot(stacked_data, aes(x = majority_habitat, y = percentage, fill = as.factor (measurementValue))) +
geom_bar(stat = "identity", position = "stack", width = 0.6) +
scale_fill_manual(values = c("1" = "skyblue", "0" = "lightcoral"),
labels = c("1 (Flocking)", "0 (No Flocking)"),
name = "Flocking Behavior") +
labs(title = "Flocking Behavior by Habitat",
x = "Habitat Type",
y = "Proportion") +
theme_minimal() +
theme (legend.position = "top",
plot.title = element_text (hjust = 0.5, size = 16), # 標題居中
plot.margin = margin (20, 20, 20, 20),
axis.title.x = element_text (margin = margin(t = 15), size = 12),
axis.title.y = element_text (margin = margin(r = 10), size = 12),
axis.text.x = element_text (size = 12),
axis.text.y = element_text (size = 12) +
stat_compare_means(method = "fisher.test", aes(label = ..p.format..), label.y = 1.0) )  # 添加橫線)
ggplot(stacked_data, aes(x = majority_habitat, y = percentage, fill = as.factor (measurementValue))) +
geom_bar(stat = "identity", position = "stack", width = 0.6) +
scale_fill_manual(values = c("1" = "skyblue", "0" = "lightcoral"),
labels = c("1 (Flocking)", "0 (No Flocking)"),
name = "Flocking Behavior") +
labs(title = "Flocking Behavior by Habitat",
x = "Habitat Type",
y = "Proportion") +
theme_minimal() +
theme (legend.position = "top",
plot.title = element_text (hjust = 0.5, size = 16), # 標題居中
plot.margin = margin (20, 20, 20, 20),
axis.title.x = element_text (margin = margin(t = 15), size = 12),
axis.title.y = element_text (margin = margin(r = 10), size = 12),
axis.text.x = element_text (size = 12),
axis.text.y = element_text (size = 12) +
annotate("text", x = 1.5, y = 0.9, label = "*", size = 6, color = "red") +  # 星號
annotate("segment", x = 1, xend = 2, y = 0.85, yend = 0.85, color = "black", size = 0.5))
ggplot(stacked_data, aes(x = majority_habitat, y = percentage, fill = as.factor (measurementValue))) +
geom_bar(stat = "identity", position = "stack", width = 0.6) +
scale_fill_manual(values = c("1" = "skyblue", "0" = "lightcoral"),
labels = c("1 (Flocking)", "0 (No Flocking)"),
name = "Flocking Behavior") +
labs(title = "Flocking Behavior by Habitat",
x = "Habitat Type",
y = "Proportion") +
theme_minimal() +
theme (legend.position = "top",
plot.title = element_text (hjust = 0.5, size = 16), # 標題居中
plot.margin = margin (20, 20, 20, 20),
axis.title.x = element_text (margin = margin(t = 15), size = 12),
axis.title.y = element_text (margin = margin(r = 10), size = 12),
axis.text.x = element_text (size = 12),
axis.text.y = element_text (size = 12)) +
annotate("text", x = 1.5, y = 0.9, label = "*", size = 6, color = "black") +  # 星號
annotate("segment", x = 1, xend = 2, y = 0.85, yend = 0.85, color = "black", size = 0.5)
library(ggpubr)
ggplot(stacked_data, aes(x = majority_habitat, y = percentage, fill = as.factor (measurementValue))) +
geom_bar(stat = "identity", position = "stack", width = 0.6) +
scale_fill_manual(values = c("1" = "skyblue", "0" = "lightcoral"),
labels = c("1 (Flocking)", "0 (No Flocking)"),
name = "Flocking Behavior") +
labs(title = "Flocking Behavior by Habitat",
x = "Habitat Type",
y = "Proportion") +
theme_minimal() +
theme (legend.position = "top",
plot.title = element_text (hjust = 0.5, size = 16), # 標題居中
plot.margin = margin (20, 20, 20, 20),
axis.title.x = element_text (margin = margin(t = 15), size = 12),
axis.title.y = element_text (margin = margin(r = 10), size = 12),
axis.text.x = element_text (size = 12),
axis.text.y = element_text (size = 12)) +
annotate("text", x = 1.5, y = 0.9, label = "*", size = 6, color = "black") +  # 星號
annotate("segment", x = 1, xend = 2, y = 1.2, yend = 1.2, color = "black", size = 0.5)
gplot(stacked_data, aes(x = majority_habitat, y = percentage, fill = as.factor (measurementValue))) +
geom_bar(stat = "identity", position = "stack", width = 0.6) +
scale_fill_manual(values = c("1" = "skyblue", "0" = "lightcoral"),
labels = c("1 (Flocking)", "0 (No Flocking)"),
name = "Flocking Behavior") +
labs(title = "Flocking Behavior by Habitat",
x = "Habitat Type",
y = "Proportion") +
theme_minimal() +
theme (legend.position = "top",
plot.title = element_text (hjust = 0.5, size = 16), # 標題居中
plot.margin = margin (20, 20, 20, 20),
axis.title.x = element_text (margin = margin(t = 15), size = 12),
axis.title.y = element_text (margin = margin(r = 10), size = 12),
axis.text.x = element_text (size = 12),
axis.text.y = element_text (size = 12)) +
annotate("text", x = 1.5, y = 1.07, label = "*", size = 6, color = "black") +  # 星號
annotate("segment", x = 1, xend = 2, y = 1.05, yend = 1.05, color = "black", size = 0.5)
ggplot(stacked_data, aes(x = majority_habitat, y = percentage, fill = as.factor (measurementValue))) +
geom_bar(stat = "identity", position = "stack", width = 0.6) +
scale_fill_manual(values = c("1" = "skyblue", "0" = "lightcoral"),
labels = c("1 (Flocking)", "0 (No Flocking)"),
name = "Flocking Behavior") +
labs(title = "Flocking Behavior by Habitat",
x = "Habitat Type",
y = "Proportion") +
theme_minimal() +
theme (legend.position = "top",
plot.title = element_text (hjust = 0.5, size = 16), # 標題居中
plot.margin = margin (20, 20, 20, 20),
axis.title.x = element_text (margin = margin(t = 15), size = 12),
axis.title.y = element_text (margin = margin(r = 10), size = 12),
axis.text.x = element_text (size = 12),
axis.text.y = element_text (size = 12)) +
annotate("text", x = 1.5, y = 1.07, label = "*", size = 6, color = "black") +  # 星號
annotate("segment", x = 1, xend = 2, y = 1.05, yend = 1.05, color = "black", size = 0.5)
ggplot(stacked_data, aes(x = majority_habitat, y = percentage, fill = as.factor (measurementValue))) +
geom_bar(stat = "identity", position = "stack", width = 0.6) +
scale_fill_manual(values = c("1" = "skyblue", "0" = "lightcoral"),
labels = c("1 (Flocking)", "0 (No Flocking)"),
name = "Flocking Behavior") +
labs(title = "Flocking Behavior by Habitat",
x = "Habitat Type",
y = "Proportion") +
scale_y_continuous (limits = c (0, 1), breaks = seq (0, 1, 0.2), labels = scale::label_percent (accuracy = 1)) +
theme_minimal() +
theme (legend.position = "top",
plot.title = element_text (hjust = 0.5, size = 16), # 標題居中
plot.margin = margin (20, 20, 20, 20),
axis.title.x = element_text (margin = margin(t = 15), size = 12),
axis.title.y = element_text (margin = margin(r = 10), size = 12),
axis.text.x = element_text (size = 12),
axis.text.y = element_text (size = 12)) +
annotate("text", x = 1.5, y = 1.07, label = "*", size = 6, color = "black") +  # 星號
annotate("segment", x = 1, xend = 2, y = 1.05, yend = 1.05, color = "black", size = 0.5)
ggplot(stacked_data, aes(x = majority_habitat, y = percentage, fill = as.factor (measurementValue))) +
geom_bar(stat = "identity", position = "stack", width = 0.6) +
scale_fill_manual(values = c("1" = "skyblue", "0" = "lightcoral"),
labels = c("1 (Flocking)", "0 (No Flocking)"),
name = "Flocking Behavior") +
labs(title = "Flocking Behavior by Habitat",
x = "Habitat Type",
y = "Proportion") +
scale_y_continuous (limits = c(0, 1), breaks = seq (0, 1, 0.2), labels = scale::label_percent (accuracy = 1)) +
theme_minimal() +
theme (legend.position = "top",
plot.title = element_text (hjust = 0.5, size = 16), # 標題居中
plot.margin = margin (20, 20, 20, 20),
axis.title.x = element_text (margin = margin(t = 15), size = 12),
axis.title.y = element_text (margin = margin(r = 10), size = 12),
axis.text.x = element_text (size = 12),
axis.text.y = element_text (size = 12)) +
annotate("text", x = 1.5, y = 1.07, label = "*", size = 6, color = "black") +  # 星號
annotate("segment", x = 1, xend = 2, y = 1.05, yend = 1.05, color = "black", size = 0.5)#
ggplot(stacked_data, aes(x = majority_habitat, y = percentage, fill = as.factor (measurementValue))) +
geom_bar(stat = "identity", position = "stack", width = 0.6) +
scale_fill_manual(values = c("1" = "skyblue", "0" = "lightcoral"),
labels = c("1 (Flocking)", "0 (No Flocking)"),
name = "Flocking Behavior") +
labs(title = "Flocking Behavior by Habitat",
x = "Habitat Type",
y = "Proportion") +
scale_y_continuous (limits = c(0, 1), breaks = seq (0, 1, 0.2), labels = c("0.00", "0.20", "0.40", "0.60", "0.80", "1.00")) +
theme_minimal() +
theme (legend.position = "top",
plot.title = element_text (hjust = 0.5, size = 16), # 標題居中
plot.margin = margin (20, 20, 20, 20),
axis.title.x = element_text (margin = margin(t = 15), size = 12),
axis.title.y = element_text (margin = margin(r = 10), size = 12),
axis.text.x = element_text (size = 12),
axis.text.y = element_text (size = 12)) +
annotate("text", x = 1.5, y = 1.07, label = "*", size = 6, color = "black") +  # 星號
annotate("segment", x = 1, xend = 2, y = 1.05, yend = 1.05, color = "black", size = 0.5)
library(ggplot2)
ggplot(stacked_data, aes(x = majority_habitat, y = percentage, fill = as.factor (measurementValue))) +
geom_bar(stat = "identity", position = "stack", width = 0.6) +
scale_fill_manual(values = c("1" = "skyblue", "0" = "lightcoral"),
labels = c("1 (Flocking)", "0 (No Flocking)"),
name = "Flocking Behavior") +
labs(title = "Flocking Behavior by Habitat",
x = "Habitat Type",
y = "Proportion") +
scale_y_continuous (limits = c(0, 1), breaks = seq (0, 1, 0.2), labels = c("0.00", "0.20", "0.40", "0.60", "0.80", "1.00")) +
theme_minimal() +
theme (legend.position = "top",
plot.title = element_text (hjust = 0.5, size = 16), # 標題居中
plot.margin = margin (20, 20, 20, 20),
axis.title.x = element_text (margin = margin(t = 15), size = 12),
axis.title.y = element_text (margin = margin(r = 10), size = 12),
axis.text.x = element_text (size = 12),
axis.text.y = element_text (size = 12)) +
annotate("text", x = 1.5, y = 1.07, label = "*", size = 6, color = "black") +  # 星號
annotate("segment", x = 1, xend = 2, y = 1.05, yend = 1.05, color = "black", size = 0.5)
ggplot(stacked_data, aes(x = majority_habitat, y = percentage, fill = as.factor (measurementValue))) +
geom_bar(stat = "identity", position = "stack", width = 0.6) +
scale_fill_manual(values = c("1" = "skyblue", "0" = "lightcoral"),
labels = c("1 (Flocking)", "0 (No Flocking)"),
name = "Flocking Behavior") +
labs(title = "Flocking Behavior by Habitat",
x = "Habitat Type",
y = "Proportion") +
scale_y_continuous (limits = c(0, 1), breaks = seq (0, 1, 0.2), labels = c("0.00", "0.20", "0.40", "0.60", "0.80", "1.00")) +
theme_minimal() +
theme (legend.position = "top",
plot.title = element_text (hjust = 0.5, size = 16), # 標題居中
plot.margin = margin (20, 20, 20, 20),
axis.title.x = element_text (margin = margin(t = 15), size = 12),
axis.title.y = element_text (margin = margin(r = 10), size = 12),
axis.text.x = element_text (size = 12),
axis.text.y = element_text (size = 12)) +
annotate("text", x = 1.5, y = 1.00, label = "*", size = 6, color = "black") +  # 星號
annotate("segment", x = 1, xend = 2, y = 1.00, yend = 1.00, color = "black", linewidth = 0.5)
ggplot(stacked_data, aes(x = majority_habitat, y = percentage, fill = as.factor (measurementValue))) +
geom_bar(stat = "identity", position = "stack", width = 0.6) +
scale_fill_manual(values = c("1" = "skyblue", "0" = "lightcoral"),
labels = c("1 (Flocking)", "0 (No Flocking)"),
name = "Flocking Behavior") +
labs(title = "Flocking Behavior by Habitat",
x = "Habitat Type",
y = "Proportion") +
scale_y_continuous (limits = c(0, 1.1), breaks = seq (0, 1, 0.2), labels = c("0.00", "0.20", "0.40", "0.60", "0.80", "1.00")) +
theme_minimal() +
theme (legend.position = "top",
plot.title = element_text (hjust = 0.5, size = 16), # 標題居中
plot.margin = margin (20, 20, 20, 20),
axis.title.x = element_text (margin = margin(t = 15), size = 12),
axis.title.y = element_text (margin = margin(r = 10), size = 12),
axis.text.x = element_text (size = 12),
axis.text.y = element_text (size = 12)) +
annotate("text", x = 1.5, y = 1.1, label = "*", size = 6, color = "black") +  # 星號
annotate("segment", x = 1, xend = 2, y = 1.05, yend = 1.05, color = "black", linewidth = 0.5)
fisher.test (co_flock_habitat$measurementValue, co_flock_habitat$majority_habitat)
sum (co_flock_habitat$majority_habitat == "Anthropogenic habitat")
sum (co_flock_habitat$majority_habitat == "Natural habitat")
library(ggplot2)
ggplot(stacked_data, aes(x = majority_habitat, y = percentage, fill = as.factor (measurementValue))) +
geom_bar(stat = "identity", position = "stack", width = 0.6) +
scale_fill_manual(values = c("1" = "skyblue", "0" = "lightcoral"),
labels = c("1 (Flocking)", "0 (No Flocking)"),
name = "Flocking Behavior") +
labs(title = "Flocking Behavior by Habitat",
x = "Habitat Type",
y = "Proportion") +
scale_y_continuous (limits = c(0, 1.1), breaks = seq (0, 1, 0.2), labels = c("0.00", "0.20", "0.40", "0.60", "0.80", "1.00")) +
theme_minimal() +
theme (legend.position = "top",
plot.title = element_text (hjust = 0.5, size = 16), # 標題居中
plot.margin = margin (20, 20, 20, 20),
axis.title.x = element_text (margin = margin(t = 15), size = 12),
axis.title.y = element_text (margin = margin(r = 10), size = 12),
axis.text.x = element_text (size = 12),
axis.text.y = element_text (size = 12)) +
annotate ("text", x = 1.5, y = 1.1, label = "*", size = 6, color = "black") +  # 星號
annotate ("segment", x = 1, xend = 2, y = 1.05, yend = 1.05, color = "black", linewidth = 0.5) + # 添加橫線
annotate ("text", x = 1, y = 1.05, label = "n = 189", size = 5, color = "black") +
annotate ("text", x = 2, y = 1.05, label = "n = 20", size = 5, color = "black")
stacked_data <- stacked_data %>%
group_by (majority_habitat) %>%
mutate (percentage = count / sum (count))
library(ggplot2)
ggplot(stacked_data, aes(x = majority_habitat, y = percentage, fill = as.factor (measurementValue))) +
geom_bar(stat = "identity", position = "stack", width = 0.6) +
scale_fill_manual(values = c("1" = "skyblue", "0" = "lightcoral"),
labels = c("1 (Flocking)", "0 (No Flocking)"),
name = "Flocking Behavior") +
labs(title = "Flocking Behavior by Habitat",
x = "Habitat Type",
y = "Proportion") +
scale_y_continuous (limits = c(0, 1.1), breaks = seq (0, 1, 0.2), labels = c("0.00", "0.20", "0.40", "0.60", "0.80", "1.00")) +
theme_minimal() +
theme (legend.position = "top",
plot.title = element_text (hjust = 0.5, size = 16), # 標題居中
plot.margin = margin (20, 20, 20, 20),
axis.title.x = element_text (margin = margin(t = 15), size = 12),
axis.title.y = element_text (margin = margin(r = 10), size = 12),
axis.text.x = element_text (size = 12),
axis.text.y = element_text (size = 12)) +
annotate ("text", x = 1.5, y = 1.1, label = "*", size = 6, color = "black") +  # 星號
annotate ("segment", x = 1, xend = 2, y = 1.05, yend = 1.05, color = "black", linewidth = 0.5) + # 添加橫線
annotate ("text", x = 1, y = 0.1, label = "n = 189", size = 2, color = "black") +
annotate ("text", x = 2, y = 0.1, label = "n = 20", size = 2, color = "black")
ggplot(stacked_data, aes(x = majority_habitat, y = percentage, fill = as.factor (measurementValue))) +
geom_bar(stat = "identity", position = "stack", width = 0.6) +
scale_fill_manual(values = c("1" = "skyblue", "0" = "lightcoral"),
labels = c("1 (Flocking)", "0 (No Flocking)"),
name = "Flocking Behavior") +
labs(title = "Flocking Behavior by Habitat",
x = "Habitat Type",
y = "Proportion") +
scale_y_continuous (limits = c(0, 1.1), breaks = seq (0, 1, 0.2), labels = c("0.00", "0.20", "0.40", "0.60", "0.80", "1.00")) +
theme_minimal() +
theme (legend.position = "top",
plot.title = element_text (hjust = 0.5, size = 16), # 標題居中
plot.margin = margin (20, 20, 20, 20),
axis.title.x = element_text (margin = margin(t = 15), size = 12),
axis.title.y = element_text (margin = margin(r = 10), size = 12),
axis.text.x = element_text (size = 12),
axis.text.y = element_text (size = 12)) +
annotate ("text", x = 1.5, y = 1.1, label = "*", size = 6, color = "black") +  # 星號
annotate ("segment", x = 1, xend = 2, y = 1.05, yend = 1.05, color = "black", linewidth = 0.5) + # 添加橫線
annotate ("text", x = 1, y = 0.1, label = "n = 189", size = 4, color = "black") +
annotate ("text", x = 2, y = 0.1, label = "n = 20", size = 4, color = "black")
ggplot(stacked_data, aes(x = majority_habitat, y = percentage, fill = as.factor (measurementValue))) +
geom_bar(stat = "identity", position = "stack", width = 0.6) +
scale_fill_manual(values = c("1" = "skyblue", "0" = "lightcoral"),
labels = c("1 (Flocking)", "0 (No Flocking)"),
name = "Flocking Behavior") +
labs(title = "Flocking Behavior by Habitat",
x = "Habitat Type",
y = "Proportion") +
scale_y_continuous (limits = c(0, 1.1), breaks = seq (0, 1, 0.2), labels = c("0.00", "0.20", "0.40", "0.60", "0.80", "1.00")) +
theme_minimal() +
theme (legend.position = "top",
panel.grid.minor.y = element_blank (),
plot.title = element_text (hjust = 0.5, size = 16), # 標題居中
plot.margin = margin (20, 20, 20, 20),
axis.title.x = element_text (margin = margin(t = 15), size = 12),
axis.title.y = element_text (margin = margin(r = 10), size = 12),
axis.text.x = element_text (size = 12),
axis.text.y = element_text (size = 12)) +
annotate ("text", x = 1.5, y = 1.1, label = "*", size = 6, color = "black") +  # 星號
annotate ("segment", x = 1, xend = 2, y = 1.05, yend = 1.05, color = "black", linewidth = 0.5) + # 添加橫線
annotate ("text", x = 1, y = 0.1, label = "n = 189", size = 4, color = "black") +
annotate ("text", x = 2, y = 0.1, label = "n = 20", size = 4, color = "black")
library(ggplot2)
ggplot(stacked_data, aes(x = majority_habitat, y = percentage, fill = as.factor (measurementValue))) +
geom_bar(stat = "identity", position = "stack", width = 0.6) +
scale_fill_manual(values = c("1" = "skyblue", "0" = "lightcoral"),
labels = c("1 (Flocking)", "0 (No Flocking)"),
name = "Flocking Behavior") +
labs(title = "Flocking Behavior by Habitat",
x = "Habitat Type",
y = "Proportion") +
scale_y_continuous (limits = c(0, 1.1), breaks = seq (0, 1, 0.2), labels = c("0.00", "0.20", "0.40", "0.60", "0.80", "1.00")) +
theme_minimal() +
theme (legend.position = "top",
panel.grid.minor.y = element_blank (),
panel.grid.major.x = element_blank (),
plot.title = element_text (hjust = 0.5, size = 16), # 標題居中
plot.margin = margin (20, 20, 20, 20),
axis.title.x = element_text (margin = margin(t = 15), size = 12),
axis.title.y = element_text (margin = margin(r = 10), size = 12),
axis.text.x = element_text (size = 12),
axis.text.y = element_text (size = 12)) +
annotate ("text", x = 1.5, y = 1.1, label = "*", size = 6, color = "black") +  # 星號
annotate ("segment", x = 1, xend = 2, y = 1.05, yend = 1.05, color = "black", linewidth = 0.5) + # 添加橫線
annotate ("text", x = 1, y = 0.1, label = "n = 189", size = 4, color = "black") +
annotate ("text", x = 2, y = 0.1, label = "n = 20", size = 4, color = "black")
ggplot(stacked_data, aes(x = majority_habitat, y = percentage, fill = as.factor (measurementValue))) +
geom_bar(stat = "identity", position = "stack", width = 0.6) +
scale_fill_manual(values = c("1" = "skyblue", "0" = "lightcoral"),
labels = c("1 (Flocking)", "0 (No Flocking)"),
name = "Flocking Behavior") +
labs(title = "Flocking Behavior by Habitat",
x = "Habitat Type",
y = "Proportion") +
scale_y_continuous (limits = c(0, 1.1), breaks = seq (0, 1, 0.2), labels = c("0.00", "0.20", "0.40", "0.60", "0.80", "1.00")) +
theme_minimal() +
theme (legend.position = "top",
panel.grid.minor.y = element_blank (),
panel.grid.major.x = element_blank (),
plot.title = element_text (hjust = 0.5, size = 16), # 標題居中
plot.margin = margin (20, 20, 20, 20),
axis.title.x = element_text (margin = margin(t = 15), size = 12),
axis.title.y = element_text (margin = margin(r = 10), size = 12),
axis.text.x = element_text (size = 12),
axis.text.y = element_text (size = 12)) +
annotate ("text", x = 1.5, y = 1.1, label = "*", size = 6, color = "black") +  # 星號
annotate ("segment", x = 1, xend = 2, y = 1.05, yend = 1.05, color = "black", linewidth = 0.5) + # 添加橫線
annotate ("text", x = 2, y = 0.1, label = "n = 189", size = 4, color = "black") +
annotate ("text", x = 1, y = 0.1, label = "n = 20", size = 4, color = "black")
